---
title: 分布式缓存
tags:
  - 缓存
categories:
  - it
  - it-java
abbrlink: 
date: 2021-04-02 16:06:20
---

[![jHes56.jpg](https://s1.ax1x.com/2022/07/19/jHes56.jpg)](https://imgtu.com/i/jHes56)

<!--more-->

## 分布式缓存设计的问题


#### 缓存预热

缓存预热指在用户请求数据之前将数据加载到缓存系统中, 用户查询事先被先预热的缓存数据, 以提高系统查询的效率. 
- 系统启动加载
- 定时加载

#### 缓存更新

更新策略4种

- 定时更新
- 过期更新
- 写请求更新: 在用户有写请求时写数据库的同时更新缓存, 这种适合用户对缓存数据和数据库的数据有一定的实时强一致性的请求.
- 读请求更新


#### 缓存淘汰策略

- FIFO: 
- LRU(Least Recently Used)
- LFU(最不经常使用)


#### 缓存雪崩

- 请求加锁
- 失效更新
- 设置不同的失效时间


#### 缓存穿透

- 布隆过滤器
- cache null策略: 指如果一个查询返回的结果为null(可能是数据不存在, 也可能是系统故障), 我们仍然缓存这个null结果, 但它的过期时间会很短, 通常不超过5分钟; 再用户再次请求该数据库时候直接返回null, 而不会继续访问数据库, 从而有效保障数据库的安全. 其实cache null策略的核心原理是: 在缓存中记录一个短暂的(数据过期内)数据在系统中是否存在的状态, 如果不存在返回null, 不查询数据库, 从而避免缓存穿透到数据库上. 


#### 缓存降级

- 写降级: 在写请求增大的时候, 可以只进行Cache的更新, 然后将数据异步更新到数据库中, 保证最终一致性即可, 即将写请求从数据库降级为Cache.
- 读降级: 在数据库服务负载过高或数据库系统故障的时候, 可以只对Cache进行读取并将结果返回给用户, 在数据库服务正常后再去查询数据库, 即将读请求从数据库降级为Cache. 